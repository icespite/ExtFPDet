LTK.prototype.LtkPrefCenterIframe=new function(){function p(n,t,i){var r=n.addEventListener?"addEventListener":"attachEvent",u=n[r],f=r=="attachEvent"?"on"+t:t;u(f,i,!1)}function w(n,t){var r=g(n),i=document.createElement("iframe");i.id="ltkPrefCenter";i.frameBorder=0;i.style.height="0px";i.style.width="100%";i.style.overflowY="hidden";i.scrolling="no";i.src=r;t(n,i);p(window,"message",function(n){n.origin.indexOf("listrak")>-1&&f(n.data)})}function b(){var n=window.addEventListener?"addEventListener":"attachEvent",t=window[n],i=n=="attachEvent"?"onmessage":"message";t(i,function(n){n.origin.indexOf("listrak")>-1&&f(n.data)},!1)}function f(n){try{obj=JSON.parse(n);obj.height&&d(obj.height);obj.reload&&k()}catch(t){_ltk_util.consoleLog("Error Parsing Message: ");_ltk_util.consoleLog(t)}}function k(){window.scrollTo(0,0)}function d(n){var r,t=document.getElementById("prefcenter"),i;r=t==="undefined"||t==null?u>n?u:n:t.attributes["min-height"]!="undefined"||t.attributes["min-height"]!=null?t.attributes["min-height"].value<n?n:t.attributes["min-height"]:n;i=document.getElementById("ltkPrefCenter");i&&(i.style.height=r+"px")}function g(t){var u=t.getAttribute(n).trim(),f=_ltk_util.getQuerystringValue(r)||t.getAttribute(s),i=tt(t.attributes),e=ut(u,f),o=(new Date).getTime();return e+"?ltkdtn="+o+(i==""?"":i)}function nt(t){return t.indexOf("data-ltk")>-1&&t!=n}function tt(n){var t=rt(document.location.search.substring(1)),i,u,f,o,s,h,e;for(t.refUrl=l,i="",u=0;u<n.length;u++)f=n[u],o=f.name,f.specified&&nt(o)&&(s=o.replace("data-ltk-",""),h=f.value,t[s]=h,s=="email"&&(t.ltkor=1));for(e in t)e!=r&&(i+="&"+e+"="+encodeURIComponent(t[e]));return _ltk_util.consoleLog("queryString: "+i),i}function it(n){return n.indexOf("trk_")==0||n.indexOf("utm_")==0}function rt(n){for(var u={},i=n.split("&"),r,t=0;t<i.length;t++)i[t]&&!it(i[t])&&(r=i[t].split("="),u[r[0]]=decodeURIComponent(r[1]));return u}function ut(n,t){var i=t?t+".html":"index.html",r=h?"/test/":"/";return v+n+r+i}var t=this,e="1.2",o="Added ability to direct to specific page with query string;",n="data-ltk-prefcenter",s="data-ltk-page",h=_ltk_util.getQuerystringValue("ltkprefcentertestmode")==="1",c=_ltk_util.getQuerystringValue("ltkstaging")==="1",i="https:"==document.location.protocol?"https://":"http://",r="ltkpage",l=i+document.location.host,a=c?"Client-Staging":"Client",v=i+"services.listrak.com/"+a+"/PrefCenter/",y=!0,u=250;t.Render=function(t){var r,i,u;for(t!=undefined&&typeof t=="boolean"&&(y=t),r=document.querySelectorAll("["+n+"]"),i=0;i<r.length;i++)u=r[i],w(u,function(n,t){n.appendChild(t)});b()};t.getVersion=function(){console.log("LtkPrefCenterFrame Version: "+e+"; Last update: "+o)}};_ltk.LtkPrefCenterIframe.Render(!0)